---
- name: Windows Server 2016 IIS ì„¤ì¹˜/ì‚­ì œ ë‹¨ì¼ í”Œë ˆì´ë¶ (ë¡œì»¬ index.html ì „ì†¡)
  hosts: windows
  gather_facts: no

  tasks:
    # =========================================
    # ğŸŒ IIS ì„¤ì¹˜/êµ¬ì„± (install íƒœê·¸ë¡œë§Œ ì‹¤í–‰)
    # =========================================
    - name: IIS(Web-Server) ë° ê´€ë¦¬ ì½˜ì†” ì„¤ì¹˜
      win_feature:
        name:
          - Web-Server
          - Web-Mgmt-Console
        state: present
        include_sub_features: yes
        include_management_tools: yes
      tags:
        - install

    - name: ì›¹ ë£¨íŠ¸ í´ë” ìƒì„±
      win_file:
        path: C:\inetpub\wwwroot
        state: directory
      tags:
        - install

    - name: ë¡œì»¬ index.html íŒŒì¼ì„ IIS ì›¹ ë£¨íŠ¸ë¡œ ì „ì†¡
      win_copy:
        src: ./index.html
        dest: C:\inetpub\wwwroot\index.html
      tags:
        - install

    - name: IIS ì„œë¹„ìŠ¤(W3SVC) ì‹œì‘ ë° ìë™ ì‹œì‘
      win_service:
        name: W3SVC
        state: started
        start_mode: auto
      tags:
        - install

        - name: IIS ì„œë¹„ìŠ¤(W3SVC) ì¤‘ì§€
      win_service:
        name: W3SVC
        state: stopped
      ignore_errors: yes
      tags:
        - remove

    - name: IIS(Web-Server) ë° ê´€ë¦¬ ì½˜ì†” ì œê±°
      win_feature:
        name:
          - Web-Server
          - Web-Mgmt-Console
        state: absent
        include_sub_features: yes
        include_management_tools: yes
      tags:
        - remove
         
    - name: wwwroot í´ë” ì†Œìœ ê¶Œ ê°€ì ¸ì˜¤ê¸°
      win_shell: |
        takeown /f C:\inetpub\wwwroot /r /d y
        icacls C:\inetpub\wwwroot /grant Administrators:F /t
      tags:
        - remove


    - name: ì›¹ ë£¨íŠ¸ í´ë” ì‚­ì œ
      win_file:
        path: C:\inetpub\wwwroot
        state: absent
      tags:
        - remove